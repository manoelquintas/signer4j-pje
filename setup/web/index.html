<!DOCTYPE html>
<html>
   <head>
      <meta charset="ISO-8859-1">
      <title>Pje API</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
      <style>
         ul{
         list-style-type: none; /* Remove bullets */
         }
         div {
         background-color: #e6ffe6;
         border: solid 1px;
         }
      </style>
      <script src="/pjeOffice/api/?file=pjeoffice-pro.js"></script>
      <script>
         const onSuccess = function(data, response) {
         	alert("SUCCESS! (" + readJson(data) + " : " + response.status + ")");
         };
         const onFailed = function(status, response) {
         	alert("FAILED!");
         };
         const apiContext = {   		
           'onSuccess': onSuccess, 
           'onFailed': onFailed
         };
         
         const documents1 = 'id=1&codIni=1&md5=ba560650ddd4dd6bd819e9a056986ed5&isBin=false,id=2&codIni=2&md5=c6db06dcd7aef21f006198694cf48649&isBin=false';
         
         const documents2 = [
           {"nome": "arquivo",  "url": "/pjefake", "paramsEnvio": ["foo=bar", "what=ever"]},
           {"nome": "arquivo",  "url": "/pjefake", "paramsEnvio": ["foo=bar", "what=ever", "code=sample"]},
           {"nome": "arquivo",  "url": "/pjefake", "paramsEnvio": ["foo=bar", "what=ever"]}
         ];
         
         const documents3 = [
           {"hashDoc": "fc3ff98e8c6a0d3087d515c0473f8677",  "conteudoBase64": "aGVsbG8gd29ybGQh"},
           {"hashDoc": "5961d2cdf0e51fb952e80cf2b7beb643",  "conteudoBase64": "c2FtcGxlIGNvZGUh="}      
         ];
      </script>
   </head>
   <body>
      <ul>
         <li>
            <strong>PjeOffice API - Quick Demo</strong>
            <p>
               Para se fazer uso desta demonstração habilite temporariamente o <em>'Modo inseguro'</em> clicando em <em>Opções -> Modo inseguro</em>
            </p>
         </li>
      </ul>
      <ul>
         <li>
            <strong>Utilities code</strong><br>
            sample:
            <div>
               <pre>
  const onSuccess = function(data, response) {
    alert("SUCCESS (" + readJson(data) + " : " + response.status + ")");
  };
  const onFailed = function(status, response) {
    alert("FAILED!");
  };</pre>
            </div>
            <hr>
         </li>         
      </ul>
      
      <ul>
         <li>
            <strong>PjeOffice.login = function(welcomeMessage, apiContext)</strong><br>
            docs:
			<div>			
			<pre>
  welcomeMessage: É a mensagem 'aleatória' a ser assinada para garantia de autenticação pós validação (obrigatório)

  apiContext = {
    "subject": {
    "POST_TIMEOUT"      : 600000,                //Opcional: se não informado será considerado defaultSubject.POST_TIMEOUT   
    "PAGINA_LOGIN"      : "/pjefake",            //Opcional: se não informado será considerado defaultSubject.PAGINA_LOGIN  
    },
    "onSuccess": function(data, response) {},      //Opcional: se não informada a notificação é ignorada
    "onFailed": function(statusText, response) {}  //Opcional: se não informada a notificação é ignorada
  };</pre>
			</div>            
            sample:
            <div>
               <pre>
  &lt;button onclick=&quot;PjeOffice.login('your welcome message', apiContext);&quot;&gt;
	LOGIN
  &lt;/button&gt;</pre>
            </div>
            <p>test:</p>
            <button onclick="PjeOffice.login('welcomeMessage', apiContext);">
            LOGIN
            </button>
            <hr>
         </li>
         <li>
            <strong>PjeOffice.loginSSO = function(welcomeMessage, token, apiContext)</strong><br>
            
			<div>			
			<pre>
  welcomeMessage:  É a mensagem 'aleatória' a ser assinada para garantia de autenticação pós validação (obrigatório).

  token: O token de autenticação SSO (obrigatório)

  apiContext = {
    "subject": {
      "POST_TIMEOUT"      : 600000,                //Opcional: se não informado será considerado defaultSubject.POST_TIMEOUT   
      "PAGINA_LOGIN"      : "/pjefake",            //Opcional: se não informado será considerado defaultSubject.PAGINA_LOGIN  
    },
    "onSuccess": function(data, response) {},      //Opcional: se não informada a notificação é ignorada
    "onFailed": function(statusText, response) {}  //Opcional: se não informada a notificação é ignorada
  };</pre>
			</div>            
            sample:
            <div>
               <pre>
  &lt;button onclick=&quot;PjeOffice.loginSSO('your welcome message', 'your token', apiContext);&quot;&gt;
	LOGIN SSO
  &lt;/button&gt;</pre>
            </div>
            <p>test:</p>
            <button onclick="PjeOffice.loginSSO('welcomeMessage', 'tokengerado', apiContext);">
            LOGIN SSO
            </button>
            <hr>
         </li>
         <li>
            <strong>PjeOffice.logout = function(apiContext)</strong><br>
            sample:
            <div>
               <pre>
  &lt;button onclick=&quot;PjeOffice.logout(apiContext);&quot;&gt;
	LOGOUT
  &lt;/button&gt;</pre>
            </div>
            <p>test:</p>
            <button onclick="PjeOffice.logout(apiContext);">
            LOGOUT
            </button>						
            <hr>
         </li>
         <li>
            <strong>PjeOffice.signHash = function(documents, apiContext)</strong><br>
            sample:
            <div>
               <pre>
  const documents = 'id=1&codIni=1&md5=ba560650ddd4dd6bd819e9a056986ed5&isBin=false,id=2&codIni=2&md5=c6db06dcd7aef21f006198694cf48649&isBin=false';

  &lt;button onclick=&quot;PjeOffice.signHash(documents1, apiContext);&quot;&gt;
	SIGN DOCUMENT HASH'S
  &lt;/button&gt;</pre>
            </div>
            <p>test:</p>
            <button onclick="PjeOffice.signHash(documents1, apiContext);">
            SIGN DOCUMENT HASH'S
            </button>						
            <hr>
         </li>
         <li>
            <strong>PjeOffice.signRemoteP7s = function(apiContext)</strong><br>
            docs:
			<div>			
			<pre>
  documents = [
    {"nome": "arquivo",  "url": "/pagina_download?p=1", "paramsEnvio": ["foo=bar", "what=ever"]},
    {"nome": "arquivo",  "url": "/pagina_download?p=2", "paramsEnvio": ["foo=bar", "what=ever", "code=sample"]},
    {"nome": "arquivo",  "url": "/pagina_download?p=3", "paramsEnvio": ["foo=bar", "what=ever"]}
  ];

  Onde:
    nome:        O nome do campo/parâmetro que chegará no servidor contendo a assinatura do documento 
    url:         A url da página de download que entrega os arquivos a serem assinados em P7S
    paramsEnvio: Parâmetros adicionais a serem enviados juntamente com a assinatura em P7S

  apiContext = {
    "subject": {
      "POST_TIMEOUT"  : 600000,                    //Opcional: se não informado será considerado defaultSubject.POST_TIMEOUT   
      "PAGINA_UPLOAD" : "/pjefake"                 //Opcional: se não informado será considerado defaultSubject.PAGINA_UPLOAD
    },
    "onSuccess": function(data, response) {},      //Opcional: se não informada a notificação é ignorada
    "onFailed": function(statusText, response) {}  //Opcional: se não informada a notificação é ignorada
  };</pre>
			</div>            
            sample:
            <div>
               <pre>
  &lt;button onclick=&quot;PjeOffice.signRemoteP7s(documents, apiContext);&quot;&gt;
	SIGN REMOTE DOCUMENT 
  &lt;/button&gt;</pre>
            </div>
            <p>test:</p>
            <button onclick="PjeOffice.signRemoteP7s(documents2, apiContext);">
            SIGN REMOTE DOCUMENT
            </button>						
            <hr>
         </li>
         <li>
            <strong>PjeOffice.signBase64 = function(documents, apiContext)</strong><br>
			docs:
			<div>			
			<pre>
  documents = [
    {"hashDoc": "fc3ff98e8c6a0d3087d515c0473f8677",  "conteudoBase64": "aGVsbG8gd29ybGQh"},
    {"hashDoc": "5961d2cdf0e51fb952e80cf2b7beb643",  "conteudoBase64": "c2FtcGxlIGNvZGUh="}      
  ];

  Onde: 
    hashDoc:        O hash do documento a ser assinado
    conteudoBase64: O conteúdo a ser assinado encodado em formato base 64

  apiContext = {
    "subject": {
      "POST_TIMEOUT"  : 600000,                    //Opcional: se não informado será considerado defaultSubject.POST_TIMEOUT   
      "PAGINA_UPLOAD" : "/pjefake"                 //Opcional: se não informado será considerado defaultSubject.PAGINA_UPLOAD
    },
    "onSuccess": function(data, response) {},      //Opcional: se não informada a notificação é ignorada
    "onFailed": function(statusText, response) {}  //Opcional: se não informada a notificação é ignorada
  };</pre>
			</div>
			            
            sample:
            <div>
               <pre>
  &lt;button onclick=&quot;PjeOffice.signBase64(documents, apiContext);&quot;&gt;
	SIGN REMOTE DOCUMENT 
  &lt;/button&gt;
			</pre>
            </div>
            <p>test:</p>
            <button onclick="PjeOffice.signBase64(documents3, apiContext);">
            SIGN BASE64 DOCUMENT
            </button>						
            <hr>
         </li>
         
      </ul>
   </body>
</html>